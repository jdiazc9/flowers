genotypeTransitions[i,(i+1):length(genotypeNames)] <- x
}
genotypeTransitions[is.na(genotypeTransitions)] <- F
###  ###
View(genotypeTransitions)
install.packages("nloptr")
library(nloptr)
?nloptr
rm(list=ls())
setwd("C:\Users\Juan\Desktop\gastos")
setwd("~\Desktop\gastos")
install.packages("blogdown")
blogdown::install_hugo(version = "0.60.1", force = TRUE)
setwd("~\Desktop\")
setwd("~")
getwd()
rm(list=ls())
install.packages("readtext")
setwd("C:\Users\Juan\Desktop")
setwd("C:\Users\Juan\Desktop\flowers")
setwd("C:/Users/Juan/Desktop/flowers")
setwd("~")
getwd()
setwd("C:/Users/Juan/Desktop/flowers")
setwd("C:/Users/Juan/Desktop/flowers/data")
x <- read.csv("flower_isolates_sequences.txt")
x <- read.csv("flower_isolates_sequences.txt",header=F,row.names=F)
x <- read.csv("flower_isolates_sequences.txt",header=F)
View(x)
x <- read.csv("flower_isolates_sequences.txt",header=F,sep="\n")
View(x)
raw_data <- read.csv("flower_isolates_sequences.txt",header=F,sep="\n")
length(x)\
length(x)
size(x)
sim(x)
dim(x)
dim(x)[1]
n <- seq(1,dim(raw_data)[1],by=3)
head(n)
rm(list=ls())
raw_data <- read.csv("flower_isolates_sequences.txt",header=F,sep="\n")
n <- seq(1,dim(raw_data)[1],by=3)
raw_data <- data.frame(species_id=raw_data[n,],
sequence_16s=raw_data[n+1,],
sequence_id=raw_data[n+2,])
View(raw_data)
rm(list=ls())
raw_data <- read.csv("flower_isolates_sequences.txt",header=F,sep="\n")
grepl(pattern=">",raw_data)
sapply(grepl(pattern=">"),raw_data)
sapply(raw_datagrepl(pattern=">"))
sapply(raw_data,grepl(pattern=">"))
sapply(raw_data,FUN=function(x) grepl(pattern=">",x))
sapply(raw_data,FUN=function(x) grepl(pattern=">",x)))
which(sapply(raw_data,FUN=function(x) grepl(pattern=">",x)))
n <- which(sapply(raw_data,FUN=function(x) grepl(pattern=">",x)))
length(n)
data_split <- vector(mode="list")
rm(list=ls())
data_raw <- read.csv("flower_isolates_sequences.txt",header=F,sep="\n")
n <- which(sapply(data_raw,FUN=function(x) grepl(pattern=">",x)))
data_split <- vector(mode="list")
for (i in 1:(length(n)-1)) {
data_split[[i]] <- data_raw[n[i]:(n[i+1]),]
}
View(data_split)
data_split[[1]]
rm(list=ls())
data_raw <- read.csv("flower_isolates_sequences.txt",header=F,sep="\n")
n <- which(sapply(data_raw,FUN=function(x) grepl(pattern=">",x)))
data_split <- vector(mode="list")
for (i in 1:(length(n)-1)) {
data_split[[i]] <- data_raw[n[i]:(n[i-1]),]
}
rm(list=ls())
data_raw <- read.csv("flower_isolates_sequences.txt",header=F,sep="\n")
n <- which(sapply(data_raw,FUN=function(x) grepl(pattern=">",x)))
data_split <- vector(mode="list")
for (i in 1:(length(n)-1)) {
data_split[[i]] <- data_raw[n[i]:(n[i+1]-1),]
}
data_split[[1]]
View(data_split)
data_split[[6]]
data_split[[6]][1]
data_split[[6]][2]
data_split[[6]][3]
data_split[[1]]
data_split[[7]]
data_split[[13]]
data_split[[12]]
library(stringr)
data_split[[1]][2]
str_extract(data_split[[1]][2],"(?<=\\s)(.*)(?=\\s)")
str_extract(data_split[[1]][2],"(.*)(?=\\s)")
str_extract(data_split[[1]][2],"(*.)(?=\\s)")
gsub( " .*$", "", data_split[[1]][2] )
data_tab <- data.frame()
data_tab <- data.frame()
data_tab$sequence_16s <- sapply(data_split,function(x) gsub( " .*$","",x))
sapply(data_split,function(x) gsub( " .*$","",x))
data_tab$sequence_16s <- sapply(data_split,function(x) gsub( " .*$","",x[2]))
f <- function(x) gsub( " .*$","",x[2])
f(data_split)
ans <- f(data_split)
gsub(".*\\s","",data_split[[1]][2])
data_split[[1]][2]
gsub("\\s.*$","",data_split[[1]][2])
f <- function(x) gsub("\\s.*$","",x[2])
f(data_split[[1]])
f(data_split[[2]])
f(data_split[[6]])
f(data_split[[7]])
data_tab <- data.frame(species_id=character()
data_tab <- data.frame(species_id=character())
data_tab$sequence_16s <- sapply(data_split,function(x) gsub("\\s.*$","",x[2]))
data_tab <- data.frame(species_id=character())
x <_ sapply(data_split,function(x) gsub("\\s.*$","",x[2]))
x <- sapply(data_split,function(x) gsub("\\s.*$","",x[2]))
x
View(data_tab)
data_tab$sequence_16s <- sapply(data_split,function(x) gsub("\\s.*$","",x[2]))
rm(list=ls())
library(stringr)
data_raw <- read.csv("flower_isolates_sequences.txt",header=F,sep="\n")
n <- which(sapply(data_raw,FUN=function(x) grepl(pattern=">",x)))
data_split <- vector(mode="list")
for (i in 1:(length(n)-1)) {
data_split[[i]] <- data_raw[n[i]:(n[i+1]-1),]
}
data_tab <- data.frame(species_id=character(),
sequence_16s=character())
data_tab$sequence_16s <- sapply(data_split,function(x) gsub("\\s.*$","",x[2]))
rm(list=ls())
library(stringr)
data_raw <- read.csv("flower_isolates_sequences.txt",header=F,sep="\n")
n <- which(sapply(data_raw,FUN=function(x) grepl(pattern=">",x)))
data_split <- vector(mode="list")
for (i in 1:(length(n)-1)) {
data_split[[i]] <- data_raw[n[i]:(n[i+1]-1),]
}
data_tab <- data.frame(species_id=NA,
sequence_16s=sapply(data_split,function(x) gsub("\\s.*$","",x[2])))
View(data_tab)
x <- sapply(data_split,function(x) gsub("\\s.*\\.","",x[1]))
x
x <- sapply(data_split,function(x) gsub("\\>.*\\.","",x[1]))
x
x <- sapply(data_split,function(x) gsub("\(*\)","",x[1]))
x <- sapply(data_split,function(x) gsub("\\(*\\)","",x[1]))
x <- sapply(data_split,function(x) gsub((?<=\>)(.*?)(?=\.),"",x[1]))
x <- sapply(data_split,function(x) gsub("(?<=\>)(.*?)(?=\.)","",x[1]))
x <- sapply(data_split,function(x) gsub("\[(.*?)\]","",x[1]))
x <- sapply(data_split,function(x) gsub(".*(.*?)\.","",x[1]))
x <- sapply(data_split,function(x) gsub(".(.*?).","",x[1]))
x <- sapply(data_split,function(x) gsub("(.*?).","",x[1]))
x <- sapply(data_split,function(x) gsub("Z(.*?).","",x[1]))
x <- sapply(data_split,function(x) gsub(">(.*?).","",x[1]))
View(data_raw)
x <- sapply(data_split,function(x) gsub(">(.*?)\\.","",x[1]))
gsub(">(.*?)\\.","",data_raw[1,])
gsub("\\>(.*?)\\.","",data_raw[1,])
gsub(">.*?\\.","",data_raw[1,])
gsub("\\.*?\\>","",data_raw[1,])
gsub("\\.(.*$","",data_raw[1,])
gsub("\\.\\(.*$","",data_raw[1,])
gsub("\\.\\(.*","",data_raw[1,])
gsub("\\.\\(","",data_raw[1,])
gsub("\\.\\(.*\\)","",data_raw[1,])
?gsub
gsub("\\.\\(.*\\)","hehe",data_raw[1,])
grep("\\.\\(.*\\)",data_raw[1,])
gsub("\\.\\(.*\\)","",data_raw[1,])
gsub("\\.\\(.*\\)","",data_raw[1,])[2:]
gsub("\\.\\(.*\\)","",data_raw[1,])[2]
gsub("\\.\\(.*\\)","",data_raw[1,])
gsub("\\.\\(.*\\)","",data_raw[1,])[1]
regex("\\.\\(.*\\)","",data_raw[1,])
regexec("\\.\\(.*\\)","",data_raw[1,])
str_extract("\\.\\(.*\\)",data_raw[1,])
str_extract(data_raw[1,],"\\.\\(.*\\)")
str_extract(data_raw[1,],"\\.\\((.*)\\)")
str_extract(data_raw[1,],"\\.\\((.*?)\\)")
str_extract(data_raw[1,],"\\.\\(*(.*?)*\\)")
str_extract(data_raw[1,],"\\(*(.*?)*\\)")
str_extract(data_raw[1,],"\\.\\(*(.*?)*\\)")
str_extract(data_raw[7,],"\\.\\(*(.*?)*\\)")
str_extract("\\.\\(*(.*?)*\\)",data_raw[7,])
gsub("\\.\\(*(.*?)*\\)","",data_raw[7,])
rm(list=ls())
library(stringr)
data_raw <- read.csv("flower_isolates_sequences.txt",header=F,sep="\n")
n <- which(sapply(data_raw,FUN=function(x) grepl(pattern=">",x)))
data_split <- vector(mode="list")
for (i in 1:(length(n)-1)) {
data_split[[i]] <- data_raw[n[i]:(n[i+1]-1),]
}
data_tab <- data.frame(species_num=sapply(data_split,function(x) gsub("\\.\\(*(.*?)*\\)","",x[1])),
sequence_16s=sapply(data_split,function(x) gsub("\\s.*$","",x[2])))
View(data_tab)
rm(list=ls())
library(stringr)
data_raw <- read.csv("flower_isolates_sequences.txt",header=F,sep="\n")
n <- which(sapply(data_raw,FUN=function(x) grepl(pattern=">",x)))
data_split <- vector(mode="list")
for (i in 1:(length(n)-1)) {
data_split[[i]] <- data_raw[n[i]:(n[i+1]-1),]
}
data_tab <- data.frame(species_id=sapply(data_split,function(x) gsub("\\.\\(*(.*?)*\\)","",x[1])),
sequence_16s=sapply(data_split,function(x) gsub("\\s.*$","",x[2])))
View(data_tab)
rm(list=ls())
library(stringr)
data_raw <- read.csv("flower_isolates_sequences.txt",header=F,sep="\n")
n <- which(sapply(data_raw,FUN=function(x) grepl(pattern=">",x)))
data_split <- vector(mode="list")
for (i in 1:(length(n)-1)) {
data_split[[i]] <- data_raw[n[i]:(n[i+1]-1),]
}
View(data_split)
data_tab <- data.frame(species_id=sapply(data_split,function(x) gsub("\\.\\(*(.*?)*\\)","",x[1])),
sequence_16s=sapply(data_split,function(x) gsub("\\s.*$","",x[2])))
View(data_tab)
x <- data_split[[1]]
str_extract(x[1],"^>.*\\.")
str_extract(x[1],"^(?<=>).*(\\.)")
str_extract(x[1],"^(?<=\\>).*(\\.)")
str_extract(x[1],"^>.*\\.")
str_extract(x[1],"^(?<=\\>).*")
str_extract(x[1],"(?<=\\>).*")
str_extract(x[1],"(?<=\\>).*(?=\\.)")
rm(list=ls())
library(stringr)
data_raw <- read.csv("flower_isolates_sequences.txt",header=F,sep="\n")
n <- which(sapply(data_raw,FUN=function(x) grepl(pattern=">",x)))
data_split <- vector(mode="list")
for (i in 1:(length(n)-1)) {
data_split[[i]] <- data_raw[n[i]:(n[i+1]-1),]
}
data_tab <- data.frame(species_id=sapply(data_split,function(x) str_extract(x[1],"(?<=\\>).*(?=\\.)")),
sequence_16s=sapply(data_split,function(x) gsub("\\s.*$","",x[2])))
View(data_tab)
View(data_split)
rm(list=ls())
library(stringr)
data_raw <- read.csv("flower_isolates_sequences.txt",header=F,sep="\n")
n <- which(sapply(data_raw,FUN=function(x) grepl(pattern=">",x)))
data_split <- vector(mode="list")
for (i in 1:(length(n)-1)) {
data_split[[i]] <- data_raw[n[i]:(n[i+1]-1),]
}
data_tab <- data.frame(species_id=sapply(data_split,function(x) str_extract(x[1],"(?<=\\>).*(?=\\.)")),
species_num=NA,
sequence_16s=sapply(data_split,function(x) gsub("\\s.*$","",x[2])))
x <- sapply(data_split,function(x) str_extract(x[1],"(?<=\\>).*(?=\\.)"))
View(data_tab)
str_extract(x[1],"(?<=\\>).*(?=\\.)")
x <- data_split[[1]]
str_extract(x[1],"(?<=\\>).*(?=\\.)")
str_extract(x[1],"(?<=\\().*(?=\\))")
numeric(str_extract(x[1],"(?<=\\().*(?=\\))"))
as.numeric(str_extract(x[1],"(?<=\\().*(?=\\))"))
rm(list=ls())
library(stringr)
data_raw <- read.csv("flower_isolates_sequences.txt",header=F,sep="\n")
n <- which(sapply(data_raw,FUN=function(x) grepl(pattern=">",x)))
data_split <- vector(mode="list")
for (i in 1:(length(n)-1)) {
data_split[[i]] <- data_raw[n[i]:(n[i+1]-1),]
}
data_tab <- data.frame(species_id=sapply(data_split,function(x) str_extract(x[1],"(?<=\\>).*(?=\\.)")),
species_num=sapply(data_split,function(x) as.numeric(str_extract(x[1],"(?<=\\().*(?=\\))"))),
sequence_16s=sapply(data_split,function(x) gsub("\\s.*$","",x[2])))
View(data_tab)
data_split[[1]]
x
x <- data_split[[1]]
x
str_extract(x[2],"(?<=\\>).*(?=\\.)")
str_extract(x[2],"(?<=\\s).*")
rm(list=ls())
library(stringr)
data_raw <- read.csv("flower_isolates_sequences.txt",header=F,sep="\n")
n <- which(sapply(data_raw,FUN=function(x) grepl(pattern=">",x)))
data_split <- vector(mode="list")
for (i in 1:(length(n)-1)) {
data_split[[i]] <- data_raw[n[i]:(n[i+1]-1),]
}
data_tab <- data.frame(species_id=sapply(data_split,function(x) str_extract(x[1],"(?<=\\>).*(?=\\.)")),
species_num=sapply(data_split,function(x) as.numeric(str_extract(x[1],"(?<=\\().*(?=\\))"))),
sequence=sapply(data_split,function(x) gsub("\\s.*$","",x[2])),
sequence_info=sapply(data_split,function(x) str_extract(x[2],"(?<=\\s).*")))
View(data_tab)
x
rm(list=ls())
library(stringr)
data_raw <- read.csv("flower_isolates_sequences.txt",header=F,sep="\n")
n <- which(sapply(data_raw,FUN=function(x) grepl(pattern=">",x)))
data_split <- vector(mode="list")
for (i in 1:(length(n)-1)) {
data_split[[i]] <- data_raw[n[i]:(n[i+1]-1),]
}
data_tab <- data.frame(species_id=sapply(data_split,function(x) str_extract(x[1],"(?<=\\>).*(?=\\.)")),
species_num=sapply(data_split,function(x) as.numeric(str_extract(x[1],"(?<=\\().*(?=\\))"))),
sequence=sapply(data_split,function(x) gsub("\\s.*$","",x[2])),
sequence_info=sapply(data_split,function(x) str_extract(x[2],"(?<=\\s).*")))
x <- data_split[[1]]
x
data_split[[2]]
x <- data_split[[1]]
str_extract(x[3],"(Sequence ID: ).*")
str_extract(x[3],"(?<=Sequence ID: ).*")
str_extract(x[3],"(?<=Sequence ID: ).*(?=L)")
str_extract(x[3],"(?<=Sequence ID: ).*(?=Length)")
View(data_split)
data_split[[13]]
data_split[[23]]
rm(list=ls())
library(stringr)
data_raw <- read.csv("flower_isolates_sequences.txt",header=F,sep="\n")
n <- which(sapply(data_raw,FUN=function(x) grepl(pattern=">",x)))
data_split <- vector(mode="list")
for (i in 1:(length(n)-1)) {
data_split[[i]] <- data_raw[n[i]:(n[i+1]-1),]
}
data_split <- sapply(data_split,paste(collapse="\t"))
rm(list=ls())
library(stringr)
data_raw <- read.csv("flower_isolates_sequences.txt",header=F,sep="\n")
n <- which(sapply(data_raw,FUN=function(x) grepl(pattern=">",x)))
data_split <- vector(mode="list")
for (i in 1:(length(n)-1)) {
data_split[[i]] <- data_raw[n[i]:(n[i+1]-1),]
}
data_split <- sapply(data_split,function(x) paste(x,collapse="\t"))
data_split
rm(list=ls())
library(stringr)
data_raw <- read.csv("flower_isolates_sequences.txt",header=F,sep="\n")
n <- which(sapply(data_raw,FUN=function(x) grepl(pattern=">",x)))
data_split <- vector(mode="list")
for (i in 1:(length(n)-1)) {
data_split[[i]] <- data_raw[n[i]:(n[i+1]-1),]
}
data_split <- sapply(data_split,function(x) paste(x,collapse=""))
data_split
data_split[13]
rm(list=ls())
library(stringr)
data_raw <- read.csv("flower_isolates_sequences.txt",header=F,sep="\n")
n <- which(sapply(data_raw,FUN=function(x) grepl(pattern=">",x)))
data_split <- vector(mode="list")
for (i in 1:(length(n)-1)) {
data_split[[i]] <- data_raw[n[i]:(n[i+1]-1),]
}
View(data_split)
data_split[[13]]
rm(list=ls())
library(stringr)
data_raw <- read.csv("flower_isolates_sequences.txt",header=F,sep="\n")
n <- which(sapply(data_raw,FUN=function(x) grepl(pattern=">",x)))
data_split <- vector(mode="list")
for (i in 1:(length(n)-1)) {
data_split[[i]] <- data_raw[n[i]:(n[i+1]-1),]
}
View(data_split)
data_tab <- data.frame(species_id=sapply(data_split,function(x) str_extract(x[1],"(?<=\\>).*(?=\\.)")),
species_num=sapply(data_split,function(x) as.numeric(str_extract(x[1],"(?<=\\().*(?=\\))"))),
sequence=sapply(data_split,function(x) gsub("\\s.*$","",x[2])),
sequence_info=sapply(data_split,function(x) str_extract(x[2],"(?<=\\s).*")),
sequence_id=sapply(data_split,function(x) str_extract(x[3],"(?<=Sequence ID: ).*(?=Length)")))
x <- data_split[[1]]
x
rm(list=ls())
library(stringr)
data_raw <- read.csv("flower_isolates_sequences.txt",header=F,sep="\n")
n <- which(sapply(data_raw,FUN=function(x) grepl(pattern=">",x)))
data_split <- vector(mode="list")
for (i in 1:(length(n)-1)) {
data_split[[i]] <- data_raw[n[i]:(n[i+1]-1),]
}
data_tab <- data.frame(species_id=sapply(data_split,function(x) str_extract(x[1],"(?<=\\>).*(?=\\.)")),
species_num=sapply(data_split,function(x) as.numeric(str_extract(x[1],"(?<=\\().*(?=\\))"))),
sequence=sapply(data_split,function(x) gsub("\\s.*$","",x[2])),
sequence_info=sapply(data_split,function(x) str_extract(x[2],"(?<=\\s).*")),
sequence_id=sapply(data_split,function(x) str_extract(x[3],"(?<=Sequence ID: ).*(?=Length)")),
sequence_length=sapply(data_split,function(x) as.numeric(str_extract(x[3],"(?<=Length: ).*(?=Number)"))))
x <- data_split[[1]]
str_extract(x[3],"(?<=Sequence ID: ).*(?=Length)")
x <- sapply(data_split,function(x) str_extract(x[3],"(?<=Sequence ID: ).*(?=Length)"))
View(data_tab)
nchar(data_tab$sequence[41])
nchar(data_tab$sequence[42])
as.numeric(str_extract(x[3],"(?<=Matches: ).*"))
x <- data_split[[1]]
as.numeric(str_extract(x[3],"(?<=Matches: ).*"))
x
rm(list=ls())
library(stringr)
data_raw <- read.csv("flower_isolates_sequences.txt",header=F,sep="\n")
n <- which(sapply(data_raw,FUN=function(x) grepl(pattern=">",x)))
data_split <- vector(mode="list")
for (i in 1:(length(n)-1)) {
data_split[[i]] <- data_raw[n[i]:(n[i+1]-1),]
}
data_tab <- data.frame(species_id=sapply(data_split,function(x) str_extract(x[1],"(?<=\\>).*(?=\\.)")),
species_num=sapply(data_split,function(x) as.numeric(str_extract(x[1],"(?<=\\().*(?=\\))"))),
sequence=sapply(data_split,function(x) gsub("\\s.*$","",x[2])),
sequence_info=sapply(data_split,function(x) str_extract(x[2],"(?<=\\s).*")),
sequence_id=sapply(data_split,function(x) str_extract(x[3],"(?<=Sequence ID: ).*(?=Length)")),
sequence_length=sapply(data_split,function(x) as.numeric(str_extract(x[3],"(?<=Length: ).*(?=Number)"))),
sequence_number_of_matches=sapply(data_split,function(x) as.numeric(str_extract(x[3],"(?<=Matches: ).*"))))
View(data_tab)
data_tab$species_name <- gsub(".*(?=\\s16S)","",data_tab$sequence_info)
data_tab$species_name <- sapply(data_tab$sequence_info,function(x) str_extract(x,".*(?=\\s16S)"))
View(data_tab)
data_tab$species_name <- sapply(data_tab$sequence_info,function(x) str_extract(x,".*(?=(\\s16S|\\scomplete))"))
rm(list=ls())
library(stringr)
data_raw <- read.csv("flower_isolates_sequences.txt",header=F,sep="\n")
n <- which(sapply(data_raw,FUN=function(x) grepl(pattern=">",x)))
data_split <- vector(mode="list")
for (i in 1:(length(n)-1)) {
data_split[[i]] <- data_raw[n[i]:(n[i+1]-1),]
}
data_tab <- data.frame(species_id=sapply(data_split,function(x) str_extract(x[1],"(?<=\\>).*(?=\\.)")),
species_num=sapply(data_split,function(x) as.numeric(str_extract(x[1],"(?<=\\().*(?=\\))"))),
sequence=sapply(data_split,function(x) gsub("\\s.*$","",x[2])),
sequence_info=sapply(data_split,function(x) str_extract(x[2],"(?<=\\s).*")),
sequence_id=sapply(data_split,function(x) str_extract(x[3],"(?<=Sequence ID: ).*(?=Length)")),
sequence_length=sapply(data_split,function(x) as.numeric(str_extract(x[3],"(?<=Length: ).*(?=Number)"))),
sequence_number_of_matches=sapply(data_split,function(x) as.numeric(str_extract(x[3],"(?<=Matches: ).*"))))
data_tab$species_name <- sapply(data_tab$sequence_info,function(x) str_extract(x,".*(?=(\\s16S|\\schromosome))"))
data_tab$species_family <- sapply(data_tab$species_full_name,function(x) str_extract(x,".*(?=\\s"))
data_tab$species_family <- sapply(data_tab$species_full_name,function(x) str_extract(x,".*(?=\\s)"))
data_tab$species_full_name <- sapply(data_tab$sequence_info,function(x) str_extract(x,".*(?=(\\s16S|\\schromosome))"))
data_tab$species_family <- sapply(data_tab$species_full_name,function(x) str_extract(x,".*(?=\\s)"))
data_tab$species_family <- sapply(data_tab$species_full_name,function(x) str_extract(x,".*\\s"))
View(data_tab)
rm(list=ls())
library(stringr)
data_raw <- read.csv("flower_isolates_sequences.txt",header=F,sep="\n")
n <- which(sapply(data_raw,FUN=function(x) grepl(pattern=">",x)))
data_split <- vector(mode="list")
for (i in 1:(length(n)-1)) {
data_split[[i]] <- data_raw[n[i]:(n[i+1]-1),]
}
data_tab <- data.frame(species_id=sapply(data_split,function(x) str_extract(x[1],"(?<=\\>).*(?=\\.)")),
species_num=sapply(data_split,function(x) as.numeric(str_extract(x[1],"(?<=\\().*(?=\\))"))),
sequence=sapply(data_split,function(x) gsub("\\s.*$","",x[2])),
sequence_info=sapply(data_split,function(x) str_extract(x[2],"(?<=\\s).*")),
sequence_id=sapply(data_split,function(x) str_extract(x[3],"(?<=Sequence ID: ).*(?=Length)")),
sequence_length=sapply(data_split,function(x) as.numeric(str_extract(x[3],"(?<=Length: ).*(?=Number)"))),
sequence_number_of_matches=sapply(data_split,function(x) as.numeric(str_extract(x[3],"(?<=Matches: ).*"))))
data_tab$species_full_name <- sapply(data_tab$sequence_info,function(x) str_extract(x,".*(?=(\\s16S|\\schromosome))"))
data_tab$species_family <- gsub("([A-Za-z]+).*","\\1",data_tab$species_full_name)
View(data_tab)
gsub("Erwinia","Erwiniaceae",data_tab$species_family)
rm(list=ls())
library(stringr)
data_raw <- read.csv("flower_isolates_sequences.txt",header=F,sep="\n")
n <- which(sapply(data_raw,FUN=function(x) grepl(pattern=">",x)))
data_split <- vector(mode="list")
for (i in 1:(length(n)-1)) {
data_split[[i]] <- data_raw[n[i]:(n[i+1]-1),]
}
data_tab <- data.frame(species_id=sapply(data_split,function(x) str_extract(x[1],"(?<=\\>).*(?=\\.)")),
species_num=sapply(data_split,function(x) as.numeric(str_extract(x[1],"(?<=\\().*(?=\\))"))),
sequence=sapply(data_split,function(x) gsub("\\s.*$","",x[2])),
sequence_info=sapply(data_split,function(x) str_extract(x[2],"(?<=\\s).*")),
sequence_id=sapply(data_split,function(x) str_extract(x[3],"(?<=Sequence ID: ).*(?=Length)")),
sequence_length=sapply(data_split,function(x) as.numeric(str_extract(x[3],"(?<=Length: ).*(?=Number)"))),
sequence_number_of_matches=sapply(data_split,function(x) as.numeric(str_extract(x[3],"(?<=Matches: ).*"))))
data_tab$species_name <- sapply(data_tab$sequence_info,function(x) str_extract(x,".*(?=(\\s16S|\\schromosome))"))
data_tab$species_family <- gsub("([A-Za-z]+).*","\\1",data_tab$species_name)
data_tab$species_family <- gsub("Pseudomonas","Pseudomonadaceae",data_tab$species_family)
data_tab$species_family <- gsub("Erwinia","Erwiniaceae",data_tab$species_family)
data_tab$species_family <- gsub("Stenotrophomonas","Xanthomonadaceae",data_tab$species_family)
data_tab$species_family <- gsub("Pantoea","Enterobacteriaceae",data_tab$species_family)
View(data_tab)
data <- data_tab[,c("species_num","species_family","species_name","species_id","sequence","sequence_info","sequence-length","sequence_number_of_matches")]
data <- data_tab[,c("species_num","species_family","species_name","species_id","sequence","sequence_info","sequence_length","sequence_number_of_matches")]
View(data)
data <- data[order(data$species_num),]
data <- data[order(data$species_family),]
rm(list=ls())
library(stringr)
data_raw <- read.csv("flower_isolates_sequences.txt",header=F,sep="\n")
n <- which(sapply(data_raw,FUN=function(x) grepl(pattern=">",x)))
data_split <- vector(mode="list")
for (i in 1:(length(n)-1)) {
data_split[[i]] <- data_raw[n[i]:(n[i+1]-1),]
}
data_tab <- data.frame(species_id=sapply(data_split,function(x) str_extract(x[1],"(?<=\\>).*(?=\\.)")),
species_num=sapply(data_split,function(x) as.numeric(str_extract(x[1],"(?<=\\().*(?=\\))"))),
sequence=sapply(data_split,function(x) gsub("\\s.*$","",x[2])),
sequence_info=sapply(data_split,function(x) str_extract(x[2],"(?<=\\s).*")),
sequence_id=sapply(data_split,function(x) str_extract(x[3],"(?<=Sequence ID: ).*(?=Length)")),
sequence_length=sapply(data_split,function(x) as.numeric(str_extract(x[3],"(?<=Length: ).*(?=Number)"))),
sequence_number_of_matches=sapply(data_split,function(x) as.numeric(str_extract(x[3],"(?<=Matches: ).*"))))
data_tab$species_name <- sapply(data_tab$sequence_info,function(x) str_extract(x,".*(?=(\\s16S|\\schromosome))"))
data_tab$species_family <- gsub("([A-Za-z]+).*","\\1",data_tab$species_name)
data_tab$species_family <- gsub("Pseudomonas","Pseudomonadaceae",data_tab$species_family)
data_tab$species_family <- gsub("Erwinia","Erwiniaceae",data_tab$species_family)
data_tab$species_family <- gsub("Stenotrophomonas","Xanthomonadaceae",data_tab$species_family)
data_tab$species_family <- gsub("Pantoea","Enterobacteriaceae",data_tab$species_family)
data <- data_tab[,c("species_num","species_family","species_name","species_id","sequence","sequence_id","sequence_info","sequence_length","sequence_number_of_matches")]
data <- data[order(data$species_num),]
data <- data[order(data$species_family),]
View(data)
View(data)
